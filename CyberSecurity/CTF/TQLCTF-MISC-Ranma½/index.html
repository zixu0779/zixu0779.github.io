<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"/><meta name="theme-color" content="#222"/><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/><meta name="renderer" content="webkit"/><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="alternate" href="/rss.xml" title="Prism Port" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Prism Port" type="application/atom+xml"><link rel="alternate" type="application/json" title="Prism Port" href="https://www.sycamore.top/feed.json"/><link rel="preconnect" href="https://s4.zstatic.net"/><link rel="preconnect" href="https://at.alicdn.com"/><link rel="preconnect" href="https://res.cloudinary.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.17"><link rel="modulepreload" href="/js/chunk-4IBW3L6M.js"></link><link rel="modulepreload" href="/js/chunk-5P4EKRVG.js"></link><link rel="modulepreload" href="/js/chunk-BYGZQFKO.js"></link><link rel="modulepreload" href="/js/chunk-KRSU34OW.js"></link><link rel="modulepreload" href="/js/chunk-WIQECBEN.js"></link><link rel="modulepreload" href="/js/chunk-ZVQ2CJZL.js"></link><link rel="modulepreload" href="/js/comments-VILBTHLY.js"></link><link rel="modulepreload" href="/js/copy-tex-JXKTIX7E.js"></link><link rel="modulepreload" href="/js/index.esm-LLUMXYOT.js"></link><link rel="modulepreload" href="/js/post-VKU266JK.js"></link><link rel="modulepreload" href="/js/quicklink-Y5RHDHHR.js"></link><link rel="modulepreload" href="/js/search-6H5WBEPN.js"></link><link rel="modulepreload" href="/js/siteInit.js"></link><link rel="modulepreload" href="/js/waline-BXO7UWYV.js"></link><link rel="stylesheet" href="/css/comments-3DIOODFJ.css" media="none" onload="this.media&#x3D;&#39;all&#39;"></link><link rel="stylesheet" href="/css/siteInit.css" media="none" onload="this.media&#x3D;&#39;all&#39;"></link><link rel="stylesheet" href="/css/waline-RZIHPP7A.css" media="none" onload="this.media&#x3D;&#39;all&#39;"></link><link rel="preload" href="h" as="image" fetchpriority="high"><link rel="preload" href="t" as="image" fetchpriority="high"><link rel="preload" href="t" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="s" as="image" fetchpriority="high"><link rel="preload" href=":" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="r" as="image" fetchpriority="high"><link rel="preload" href="e" as="image" fetchpriority="high"><link rel="preload" href="s" as="image" fetchpriority="high"><link rel="preload" href="." as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="o" as="image" fetchpriority="high"><link rel="preload" href="u" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="i" as="image" fetchpriority="high"><link rel="preload" href="n" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="r" as="image" fetchpriority="high"><link rel="preload" href="y" as="image" fetchpriority="high"><link rel="preload" href="." as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="o" as="image" fetchpriority="high"><link rel="preload" href="m" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="s" as="image" fetchpriority="high"><link rel="preload" href="y" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="m" as="image" fetchpriority="high"><link rel="preload" href="o" as="image" fetchpriority="high"><link rel="preload" href="r" as="image" fetchpriority="high"><link rel="preload" href="e" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="i" as="image" fetchpriority="high"><link rel="preload" href="m" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="g" as="image" fetchpriority="high"><link rel="preload" href="e" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="u" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="l" as="image" fetchpriority="high"><link rel="preload" href="o" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="v" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="6" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="4" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="7" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="T" as="image" fetchpriority="high"><link rel="preload" href="y" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="e" as="image" fetchpriority="high"><link rel="preload" href="r" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="4" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="b" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="b" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="f" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="b" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="5" as="image" fetchpriority="high"><link rel="preload" href="5" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="4" as="image" fetchpriority="high"><link rel="preload" href="1" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="d" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="a" as="image" fetchpriority="high"><link rel="preload" href="c" as="image" fetchpriority="high"><link rel="preload" href="." as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="n" as="image" fetchpriority="high"><link rel="preload" href="g" as="image" fetchpriority="high"><meta name="keywords" content="Python,Misc"/><meta name="description" content=" "/><link rel="canonical" href="https://www.sycamore.top/CyberSecurity/CTF/TQLCTF-MISC-Ranma%C2%BD/"><title>TQLCTF-MISC-Ranma½</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">TQLCTF-MISC-Ranma½</h1><div class="meta"><span class="item" title="创建时间：2022-02-22 22:36:41"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2022-02-22T22:36:41+08:00">2022-02-22</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>2.9k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>3 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Sycamore's Blog</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="https://res.cloudinary.com/sycamore/image/upload/v1682438327/Typera/2023/04/33bcab1c0fc91bd552a41c8dc39d23ac.png" loading="eager" decoding="async" fetchpriority="high" alt="Prism Port"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemListElement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/CyberSecurity/" itemprop="item" rel="index" title="分类于CyberSecurity"><span itemprop="name">CyberSecurity<meta itemprop="position" content="0"/></span></a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/CyberSecurity/CTF/" itemprop="item" rel="index" title="分类于CTF"><span itemprop="name">CTF<meta itemprop="position" content="1"/></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.sycamore.top/CyberSecurity/CTF/TQLCTF-MISC-Ranma%C2%BD/"/><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"/><meta itemprop="name" content="Sycamore"/><meta itemprop="description" content="Code, game mods, and random thoughts,  "/></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Prism Port"/></span><div class="body md" itemprop="articleBody"><h2 id="misc"><a class="anchor" href="#misc">#</a> MISC</h2>
<h3 id="ranma12"><a class="anchor" href="#ranma12">#</a> Ranma½</h3>
<p>终归还是少了点经验，以及一些奇奇怪怪的知识。。。</p>
<h4 id="utf-8可变长编码"><a class="anchor" href="#utf-8可变长编码">#</a> UTF-8 可变长编码</h4>
<p>首先一定要详细了解 UTF-8 编码，<br />
完整的表如下：<br />
<img loading="lazy" data-src="https://res.cloudinary.com/sycamore/image/upload/v1682438191/Typera/2023/04/fdfd2d8940cbcb3dad4d6ee71124333c.png" alt="image-20230425235627337" /></p>
<blockquote>
<p>图中一行的  <code>xxx...</code>  部分组合起来即为对应的 Unicode 代码</p>
</blockquote>
<p>可能这样还是比较难以理解，那就仔细阅读下面的例子就行了：</p>
<p>希伯来语字母 א 的 Unicode 代码是 U+<strong>05D0</strong>，UTF-8 是 <strong>0xD7 0x90</strong>，<br />
则 Unicode to UTF-8 转换如下：</p>
<ul>
<li>首先判断它属于哪一行：<br />
U+0080 到 U+07FF，观察表中对应行，说明它使用双字节，即 110<strong>xxxxx</strong> 10<strong>xxxxxx</strong></li>
<li>然后分解十六进制的<strong> 0x05D0</strong>，换算成二进制就是（0）101-1101-0000</li>
<li>最后，把这 11 位数按顺序填入前后的 &quot;x&quot; 部分：110<strong>10111</strong> 10<strong>010000</strong></li>
</ul>
<p>110<strong>10111</strong> 10<strong>010000</strong> 换成 16 进制就是 <strong>D7 90</strong>，即对应的 UTF-8 编码</p>
<p>看懂了上述例子，UTF-8 to Unicode 就是简单反过来就行了</p>
<h4 id="信息隐藏的思路"><a class="anchor" href="#信息隐藏的思路">#</a> 信息隐藏的思路</h4>
<p>到这里，我们就了解了 UTF-8 编码 “可变长” 的特点，<br />
既然它是可变长的，那么我们就可以利用<strong>这个特性</strong>去隐藏信息：<br />
直接用一般的文本编辑器打开题目给的文件，会有很多乱码，因为它们大多是逐字节转换的，而 UTF-8 的单个字符 可能有 1~4 个字节的长度，</p>
<p>因此，如果我们要隐藏 <strong>A</strong> 字符，Unicode 就是 <strong>0x41</strong>，换算成二进制就是 <strong>100 0001</strong>，<br />
再假设我们要把它藏到 UTF-8 编码的<strong>第二行 U+0080 到 U+07FF</strong> 里面，那么我们一共需要 11 个数字，<br />
于是人为地在高位填充 4 个 0，得到：<strong>000-0100-0001</strong>，再将这 11 个数字填入表中对应的 x 部分，就得到：110<strong>00001</strong> 10<strong>000001</strong>，即 UTF-8 编码的 <strong>C1 81</strong>，从而骗过大部分的文本编辑器</p>
<h4 id="解题过程"><a class="anchor" href="#解题过程">#</a> 解题过程</h4>
<p>实际上有挺多方法，用 vim 打开，或者用 WinRAR 的 “查看” 打开（这个属实有点奇怪）<br />
<img loading="lazy" data-src="https://res.cloudinary.com/sycamore/image/upload/v1682438200/Typera/2023/04/1771f16334a694ed24fac59a74971010.png" alt="image-20230425235636085" /><br />
 或者可以写脚本分析：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> binascii</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"Ranma"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>		<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>			Str <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>			<span class="token keyword">if</span> <span class="token keyword">not</span> Str<span class="token punctuation">:</span><span class="token keyword">break</span></pre></td></tr><tr><td data-num="9"></td><td><pre>			x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 读文件，将 16 进制字串存入 list x</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">128</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>		y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 小于 128 的直接 chr () 转换 ASCII 码</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">127</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 大于 128 的转换为二进制分析</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	<span class="token keyword">if</span> <span class="token string">'0b110'</span> <span class="token keyword">in</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># 如果是第二行的情况</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token keyword">if</span> <span class="token string">'0b1110'</span> <span class="token keyword">in</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># 如果是第三行的情况</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token keyword">if</span> <span class="token string">'0b'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token comment"># 去除多余项并合并</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		z<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>得到：</p>
<blockquote>
<p QFOLP6_KRZ1Q="">KGR/QRI 10646-1 zswtqgg d tnxcs tsdtofbrx osk ndnzhl gna Ietygfviy Idoilfvsu Arz (QQJ) hkkqk maikaglvusv ubyp cw ekg krzyj'o kitwkbj alypsdd.  Wjs rzvmebrwoa duwcuosu pqecgqamo cw ekg IFA, uussmpu, ysum aup qfxschljyk swks pcbb khxnsee drdoqpgpwfyv cbg xeupctzou, oql gneg ylv nsg bb zds upygzrxzkjh fq XVT-8, wpr uxxvnw qt wpvy isdz. XVT-8 kif zds tsdtofbrxegktf qt szryafmtqi hkm sahz LD-DUQLQ egjuv, auqjllvtc qfxschljvrehp hlvv iqyk omjehog, sieyafj lqf cwprx ocwezcfh bugp fvwb qb XA-NYYWZ gdniha oap oip wtoqacgnsee wq cwprx rocfhu. HTTPZB</p>
</blockquote>
<p>观察猜测是维吉尼亚加密，</p>
<ol>
<li>
<p>直接爆破 <a target="_blank" rel="noopener" href="https://www.dcode.fr/vigenere-cipher">在线网址</a> ：<br />
点击 AUTOMATIC DECRYPTION，爆破即可</p>
</li>
<li>
<p>看官方 wp，（这个密钥要拿到脑洞也太大了吧。。。）<br />
依次列举出 UTF-8 编码文字的长度，长度为 1 的字符转换为<strong>点</strong>，长度为 2 的字符转换为<strong>线</strong>，长度为 3 的字符转换成<strong>分隔符</strong>，经过 <strong>Morse</strong> 解读获得密钥<br />
 (￣▽￣)&quot;<br />
<img loading="lazy" data-src="https://res.cloudinary.com/sycamore/image/upload/v1682438209/Typera/2023/04/150cd961046421d365382e0994f34fba.png" alt="image-20230425235644738" /><br />
flag： <code>TQLCTF&#123;CODIN6_WOR1D&#125;</code></p>
</li>
</ol>
<div class="tags"><a href="/tags/Python/" rel="tag"><i class="ic i-tag"></i>Python</a><a href="/tags/CTF/" rel="tag"><i class="ic i-tag"></i>CTF</a><a href="/tags/Misc/" rel="tag"><i class="ic i-tag"></i>Misc</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2025-01-21 14:58:19" itemprop="dateModified" datetime="2025-01-21T14:58:19+08:00">2025-01-21</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.png" alt="Sycamore 微信支付"/><p>微信支付</p></div><div><img loading="lazy" data-src="/assets/alipay.png" alt="Sycamore 支付宝"/><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Sycamore<i class="ic i-at"><em>@</em></i>Prism Port</li><li class="link"><strong>本文链接：</strong><a href="https://www.sycamore.top/CyberSecurity/CTF/TQLCTF-MISC-Ranma%C2%BD/" title="TQLCTF-MISC-Ranma½">https://www.sycamore.top/CyberSecurity/CTF/TQLCTF-MISC-Ranma½/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/CyberSecurity/CTF/2022hgame-week1/" rel="prev" itemprop="url" data-background-image="https:&#x2F;&#x2F;res.cloudinary.com&#x2F;sycamore&#x2F;image&#x2F;upload&#x2F;v1682438101&#x2F;Typera&#x2F;2023&#x2F;04&#x2F;8798b063d769d1c7172303ddd222745a.png" title="2022hgame week1"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>CTF</span><h3>2022hgame week1</h3></a></div><div class="item right"><a href="/HomeWork/%E6%95%B0%E5%AD%A6%E6%80%9D%E7%BB%B4%E5%9C%A8%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/" rel="next" itemprop="url" data-background-image="https:&#x2F;&#x2F;res.cloudinary.com&#x2F;sycamore&#x2F;image&#x2F;upload&#x2F;v1682440953&#x2F;Typera&#x2F;2023&#x2F;04&#x2F;d03e7e1cc30ada4331e61a76e994adc3.png" title="数学思维在密码学中的应用"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>Homework</span><h3>数学思维在密码学中的应用</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text"> MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ranma12"><span class="toc-number">1.1.</span> <span class="toc-text"> Ranma½</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#utf-8%E5%8F%AF%E5%8F%98%E9%95%BF%E7%BC%96%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text"> UTF-8 可变长编码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E9%9A%90%E8%97%8F%E7%9A%84%E6%80%9D%E8%B7%AF"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 信息隐藏的思路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 解题过程</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li ><a href="/CyberSecurity/CTF/CUMTCTF-2021%E5%9B%BD%E5%BA%86%E8%B5%9BWP%EF%BC%88%E9%83%A8%E5%88%86%EF%BC%89/" rel="bookmark" title="CUMTCTF 2021国庆赛WP（部分）">CUMTCTF 2021国庆赛WP（部分）</a></li><li ><a href="/CyberSecurity/CTF/CUMT-PWN%E4%B8%93%E9%A1%B9/" rel="bookmark" title="CUMT PWN专项">CUMT PWN专项</a></li><li ><a href="/CyberSecurity/CTF/2021DASCTF%E5%AE%9E%E6%88%98%E7%B2%BE%E8%8B%B1%E5%A4%8F%E4%BB%A4%E8%90%A5%E6%9A%A8DASCTF-July-X-CBCTF-4th-misc%E9%83%A8%E5%88%86wp/" rel="bookmark" title="2021DASCTF实战精英夏令营暨DASCTF July X CBCTF 4th misc部分wp">2021DASCTF实战精英夏令营暨DASCTF July X CBCTF 4th misc部分wp</a></li><li ><a href="/CyberSecurity/CTF/2021-%E7%BE%8A%E5%9F%8E%E6%9D%AF-wp/" rel="bookmark" title="2021-羊城杯_wp">2021-羊城杯_wp</a></li><li ><a href="/CyberSecurity/CTF/L3H2021-PWN/" rel="bookmark" title="L3H2021 PWN部分">L3H2021 PWN部分</a></li><li ><a href="/CyberSecurity/CTF/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-YUSA%E7%9A%84%E5%B0%8F%E7%A7%98%E5%AF%86/" rel="bookmark" title="西湖论剑_YUSA的小秘密">西湖论剑_YUSA的小秘密</a></li><li ><a href="/CyberSecurity/CTF/SCTF%E5%A4%8D%E7%8E%B0/" rel="bookmark" title="SCTF复现">SCTF复现</a></li><li ><a href="/CyberSecurity/CTF/2022hgame-week1/" rel="bookmark" title="2022hgame week1">2022hgame week1</a></li><li  class="active"><a href="/CyberSecurity/CTF/TQLCTF-MISC-Ranma%C2%BD/" rel="bookmark" title="TQLCTF-MISC-Ranma½">TQLCTF-MISC-Ranma½</a></li><li ><a href="/CyberSecurity/CTF/CUMTCTF-2022%E5%87%BA%E9%A2%98%E9%83%A8%E5%88%86wp/" rel="bookmark" title="CUMTCTF-2022出题部分wp">CUMTCTF-2022出题部分wp</a></li><li ><a href="/CyberSecurity/CTF/2021%E4%B8%80%E5%B8%A6%E4%B8%80%E8%B7%AF%E6%9A%A8%E9%87%91%E7%A0%96%E5%A4%A7%E8%B5%9B%E4%B9%8B%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B%E9%A1%B9%E5%86%B3%E8%B5%9BWriteUp/" rel="bookmark" title="2021一带一路暨金砖大赛之企业信息系统安全赛项决赛WriteUp">2021一带一路暨金砖大赛之企业信息系统安全赛项决赛WriteUp</a></li><li ><a href="/CyberSecurity/CTF/BxsTeam-Ciscn2022-WP/" rel="bookmark" title="BxsTeam Ciscn2022 WP">BxsTeam Ciscn2022 WP</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="Sycamore" src="/assets/avatar.jpg"/><p class="name" itemprop="name">Sycamore</p><div class="description" itemprop="description"> </div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">40</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">15</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">37</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/noneSycamore" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;noneSycamore"><i class="ic i-github"></i></a><a href="mailto:sycamore.none@gmail.com" class="item email" title="mailto:sycamore.none@gmail.com"><i class="ic i-envelope"></i></a><a target="_blank" rel="noopener" href="https://instagram.com/ziqixu41" class="item instagram" title="https:&#x2F;&#x2F;instagram.com&#x2F;ziqixu41"><i class="ic i-instagram"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-cloud"></i>关于本站</a></li></ul></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li><li class="item"><a target="_blank" href="https://www.travellings.cn/go.html" rel="section noopener"><i class="ic i-subway"></i>开往</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/HomeWork/%E6%95%B0%E5%AD%A6%E6%80%9D%E7%BB%B4%E5%9C%A8%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/CyberSecurity/CTF/2022hgame-week1/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/CyberSecurity/" title="分类于CyberSecurity">CyberSecurity</a><i class="ic i-angle-right"></i><a href="/categories/CyberSecurity/CTF/" title="分类于CTF">CTF</a></div><span><a href="/CyberSecurity/CTF/2021-%E7%BE%8A%E5%9F%8E%E6%9D%AF-wp/">2021-羊城杯_wp</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CyberSecurity/" title="分类于CyberSecurity">CyberSecurity</a><i class="ic i-angle-right"></i><a href="/categories/CyberSecurity/%E6%9C%A8%E9%A9%AC/" title="分类于木马">木马</a></div><span><a href="/CyberSecurity/%E6%9C%A8%E9%A9%AC/Metasploit-%E6%9C%A8%E9%A9%AC%E7%BC%96%E8%AF%91%E5%88%A9%E7%94%A8/">Metasploit 木马编译利用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Graduation/" title="分类于Graduation">Graduation</a><i class="ic i-angle-right"></i><a href="/categories/Graduation/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="分类于机器学习">机器学习</a></div><span><a href="/Graduation/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%85%B6%E4%BB%96%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF/">其他常用技术</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CyberSecurity/" title="分类于CyberSecurity">CyberSecurity</a><i class="ic i-angle-right"></i><a href="/categories/CyberSecurity/%E5%90%8E%E9%97%A8/" title="分类于后门">后门</a></div><span><a href="/CyberSecurity/%E5%90%8E%E9%97%A8/linux-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B8%B8%E8%A7%81%E7%9A%84%E7%95%99%E5%90%8E%E9%97%A8%E6%96%B9%E5%BC%8F%EF%BC%88%E4%BA%8C%EF%BC%89/">linux 服务器常见的留后门方式（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Graduation/" title="分类于Graduation">Graduation</a><i class="ic i-angle-right"></i><a href="/categories/Graduation/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" title="分类于深度学习">深度学习</a></div><span><a href="/Graduation/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">深度学习神经网络</a></span></li></ul></div><div class="rpost pjax"><h2>最新评论</h2><ul class="leancloud-recent-comment" id="new-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2021 -<span itemprop="copyrightYear">2025</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Sycamore @ Sycamore's Blog</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">207k 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">3:08</span></div></div><script src="https://unpkg.com/busuanzi@2.3.0/bsz.pure.mini.js"></script><script>const yearSpan = document.querySelector('span[itemprop="copyrightYear"]');
if (yearSpan) {
    yearSpan.textContent += " ";
}
const authorSpan = document.querySelector('span.author[itemprop="copyrightHolder"]');
if (authorSpan) {
    authorSpan.textContent = 'Sycamore';
}
const spanElement = document.querySelector('span[title="站点阅读时长"]');
if (spanElement) {
    spanElement.textContent = " " + spanElement.textContent
    spanElement.insertAdjacentHTML('afterend', '<span id="busuanzi_short"><span class="post-meta-divider"> | </span><span class="ic i-eye"></span> <span id="busuanzi_value_site_pv"></span><span>')
}

</script><div style="width: 100%;text-align:center;"><span id="time"></span></div><script>function createtime() {
    const n = new Date("2021/11/20 00:00:00");
    now.setTime(now.getTime() + 250), days = (now - n) / 1e3 / 60 / 60 / 24, dnum = Math.floor(days), hours = (now - n) / 1e3 / 60 / 60 - 24 * dnum, hnum = Math.floor(hours), 1 == String(hnum).length && (hnum = "0" + hnum), minutes = (now - n) / 1e3 / 60 - 1440 * dnum - 60 * hnum, mnum = Math.floor(minutes), 1 == String(mnum).length && (mnum = "0" + mnum), seconds = (now - n) / 1e3 - 86400 * dnum - 3600 * hnum - 60 * mnum, snum = Math.round(seconds), 1 == String(snum).length && (snum = "0" + snum), document.getElementById("time").innerHTML = "此站已存活 " + dnum + " 天 " + hnum + " 小时 " + mnum + " 分 " + snum + " 秒"
}
const now = new Date;
setInterval("createtime()", 250)
</script><div style="width: 100%;text-align:center;"><span id="sentences-content" style="color: #ebb563;">一言...</span></div><div style="width: 100%;text-align:center;"><span id="sentences-from">來源</span><script type="text/javascript">fetch(`https://v1.hitokoto.cn/`)
.then(response => response.json())
.then(data => {
    var content = document.getElementById('sentences-content');
    content.innerText = data.hitokoto
    var from = document.getElementById('sentences-from');
    from.innerText = data.from + (data.from_who && data.from_who != data.from ? ' · ' + data.from_who : '')
})
.catch(console.error)</script></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `CyberSecurity/CTF/TQLCTF-MISC-Ranma½/`,
        favicon: {
        show: `（●´3｀●）复活成功`,
        hide: `(´Д｀)浏览器崩溃啦`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.17" type="module" fetchpriority="high" defer></script></body></html>